{"version":3,"sources":["Game.js"],"names":["cc","Class","extends","Component","properties","starPrefab","default","type","Prefab","maxStarDuration","minStarDuration","ground","Node","player","scoreDisplay","Label","scoreAudio","AudioClip","spawnStars","newStar","instantiate","node","addChild","setPosition","getNewStarPosition","getComponent","game","timer","starDuration","Math","random","randX","width","randY","y","height","jumpHeight","v2","gainScore","score","string","audioEngine","playEffect","gameOver","gameState","stopAllActions","director","loadScene","onLoad","start","update","dt","enabled"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,oBAAa;AACTC,qBAAU,IADD;AAETC,kBAAOP,GAAGQ;AAFD,SADL;AAKRC,yBAAkB,CALV;AAMRC,yBAAkB,CANV;AAORC,gBAAS;AACLL,qBAAU,IADL;AAELC,kBAAOP,GAAGY;AAFL,SAPD;AAWRC,gBAAS;AACLP,qBAAU,IADL;AAELC,kBAAOP,GAAGY;AAFL,SAXD;AAeRE,sBAAe;AACXR,qBAAU,IADC;AAEXC,kBAAOP,GAAGe;AAFC,SAfP;;AAoBRC,oBAAa;AACTV,qBAAU,IADD;AAETC,kBAAOP,GAAGiB;AAFD;AApBL,KAHP;;AA6BLC,cA7BK,wBA6BS;AACV,YAAIC,UAAUnB,GAAGoB,WAAH,CAAe,KAAKf,UAApB,CAAd;AACA,aAAKgB,IAAL,CAAUC,QAAV,CAAmBH,OAAnB;AACAA,gBAAQI,WAAR,CAAoB,KAAKC,kBAAL,EAApB;AACAL,gBAAQM,YAAR,CAAqB,MAArB,EAA6BC,IAA7B,GAAoC,IAApC;;AAEA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,YAAL,GAAoB,KAAKlB,eAAL,GAAuB,CAAC,KAAKD,eAAL,GAAuB,KAAKC,eAA7B,IAAgDmB,KAAKC,MAAL,EAA3F;AACA;AACH,KAtCI;AAwCLN,sBAxCK,gCAwCiB;AAClB,YAAIO,QAAQ,KAAKV,IAAL,CAAUW,KAAV,IAAmB,MAAMH,KAAKC,MAAL,EAAzB,CAAZ;AACA,YAAIG,QAAQ,KAAKtB,MAAL,CAAYuB,CAAZ,GAAgB,KAAKvB,MAAL,CAAYwB,MAAZ,GAAqB,CAArC,GAAyC,KAAKtB,MAAL,CAAYY,YAAZ,CAAyB,QAAzB,EAAmCW,UAAnC,GAAgDP,KAAKC,MAAL,EAArG;AACA,eAAO9B,GAAGqC,EAAH,CAAMN,KAAN,EAAaE,KAAb,CAAP;AACH,KA5CI;AA8CLK,aA9CK,uBA8CQ;AACT,aAAKC,KAAL,IAAc,CAAd;AACA,aAAKzB,YAAL,CAAkB0B,MAAlB,GAA2B,aAAa,KAAKD,KAA7C;AACAvC,WAAGyC,WAAH,CAAeC,UAAf,CAA0B,KAAK1B,UAA/B,EAA2C,KAA3C;AACH,KAlDI;AAoDL2B,YApDK,sBAoDO;AACR,aAAKC,SAAL,GAAiB,CAAjB;AACA;AACA,aAAK/B,MAAL,CAAYgC,cAAZ;AACA7C,WAAG8C,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACH,KAzDI;AA2DLC,UA3DK,oBA2DK;AACN,aAAKrB,KAAL,GAAa,CAAb;AACA,aAAKC,YAAL,GAAoB,CAApB;;AAEA,aAAKV,UAAL;AACA,aAAKqB,KAAL,GAAa,CAAb;AACA,aAAKK,SAAL,GAAiB,CAAjB;AACA,aAAK/B,MAAL,CAAYY,YAAZ,CAAyB,QAAzB,EAAmCC,IAAnC,GAA0C,IAA1C;AACH,KAnEI;AAqELuB,SArEK,mBAqEI,CAER,CAvEI;AAyELC,UAzEK,kBAyEGC,EAzEH,EAyEO;AACR,YAAG,KAAKP,SAAL,IAAkB,CAArB,EAAwB;AACpB,gBAAG,KAAKjB,KAAL,GAAa,KAAKC,YAArB,EAAmC;AAC/B,qBAAKe,QAAL;AACA,qBAAKS,OAAL,GAAe,KAAf;AACA;AACH;AACD,iBAAKzB,KAAL,IAAcwB,EAAd;AACH;AAEJ;AAnFI,CAAT","file":"Game.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        starPrefab : {\n            default : null,\n            type : cc.Prefab\n        },\n        maxStarDuration : 0,\n        minStarDuration : 0,\n        ground : {\n            default : null,\n            type : cc.Node\n        },\n        player : {\n            default : null,\n            type : cc.Node\n        },\n        scoreDisplay : {\n            default : null,\n            type : cc.Label\n        },\n\n        scoreAudio : {\n            default : null,\n            type : cc.AudioClip\n        }\n    },\n\n    spawnStars () {\n        var newStar = cc.instantiate(this.starPrefab);\n        this.node.addChild(newStar);\n        newStar.setPosition(this.getNewStarPosition());\n        newStar.getComponent(\"Star\").game = this;\n\n        this.timer = 0;\n        this.starDuration = this.minStarDuration + (this.maxStarDuration - this.minStarDuration) * Math.random();\n        // cc.log(this.starDuration);\n    },\n\n    getNewStarPosition () {\n        var randX = this.node.width * (0.5 - Math.random());\n        var randY = this.ground.y + this.ground.height / 2 + this.player.getComponent(\"Player\").jumpHeight * Math.random();\n        return cc.v2(randX, randY);\n    },\n\n    gainScore () {\n        this.score += 1;\n        this.scoreDisplay.string = 'Score : ' + this.score;\n        cc.audioEngine.playEffect(this.scoreAudio, false);\n    },\n\n    gameOver () {\n        this.gameState = 2;\n        // cc.log(\"gameover!\");\n        this.player.stopAllActions();\n        cc.director.loadScene('game');\n    },\n\n    onLoad () {\n        this.timer = 0;\n        this.starDuration = 0;\n\n        this.spawnStars();\n        this.score = 0;\n        this.gameState = 0;\n        this.player.getComponent(\"Player\").game = this;\n    },\n\n    start () {\n\n    },\n\n    update (dt) {\n        if(this.gameState == 1) {\n            if(this.timer > this.starDuration) {\n                this.gameOver();\n                this.enabled = false;\n                return;\n            }\n            this.timer += dt;\n        }\n        \n    },\n});\n"]}