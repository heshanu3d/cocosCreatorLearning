{"version":3,"sources":["../../../../assets/Scripts/assets/Scripts/Player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","jumpAudio","default","type","AudioClip","setJumpAction","jumpUp","moveBy","v2","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","callback","callFunc","playJumpSound","repeatForever","sequence","audioEngine","playEffect","onKeyDown","event","keyCode","macro","KEY","a","accLeft","activateGameState","d","accRight","onKeyUp","game","gameState","onLoad","node","runAction","xSpeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","KEY_UP","onDestroy","off","start","update","dt","Math","abs","x"],"mappings":"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","file":"Player.js","sourceRoot":"../../../../assets/Scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://docs.cocos2d-x.org/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] https://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] https://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        jumpHeight : 0,\n        jumpDuration : 0,\n        maxMoveSpeed : 0,\n        accel : 0,\n        jumpAudio : {\n            default : null,\n            type : cc.AudioClip\n        },\n    },\n    \n    setJumpAction () {\n        var jumpUp = cc.moveBy(this.jumpDuration, cc.v2(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\n        var jumpDown = cc.moveBy(this.jumpDuration, cc.v2(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\n        var callback = cc.callFunc(this.playJumpSound, this);\n        return cc.repeatForever(cc.sequence(jumpUp, jumpDown,callback));\n    },\n\n    playJumpSound () {\n        cc.audioEngine.playEffect(this.jumpAudio, false);\n    },\n\n    onKeyDown (event) {\n        switch(event.keyCode) {\n            case cc.macro.KEY.a :\n                this.accLeft = true;\n                // cc.log(\"a down\");\n                this.activateGameState();\n                break;\n            case cc.macro.KEY.d :\n                this.accRight = true;\n                this.activateGameState();\n                // cc.log(\"d down\");\n                break;\n        }\n    },\n\n    onKeyUp (event) {\n        switch(event.keyCode){\n            case cc.macro.KEY.a :\n                this.accLeft = false;\n                // cc.log(\"a up\");\n                break;\n            case cc.macro.KEY.d :\n                this.accRight = false;\n                // cc.log(\"d up\");\n                break;\n        }\n    },\n\n    activateGameState () {\n        if(this.game.gameState != 1)\n            this.game.gameState = 1;\n    },\n    \n    onLoad () {\n        this.node.runAction(this.setJumpAction());\n        this.accLeft = false;\n        this.accRight = false;\n        this.xSpeed = 0;\n\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown,this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    onDestroy () {\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown,this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    start () {\n\n    },\n\n    update (dt) {\n        if (this.accLeft == true) {\n            this.xSpeed = this.xSpeed > 0 ? (this.xSpeed - this.accel * dt * 5) : this.xSpeed;\n            this.xSpeed -= this.accel * dt;\n            // cc.log(this.accel);\n        } else if(this.accRight) {\n            this.xSpeed = this.xSpeed > 0 ? this.xSpeed : (this.xSpeed + this.accel * dt * 5);\n            this.xSpeed += this.accel * dt;\n        }\n\n        this.xSpeed = this.xSpeed > 0 ? (this.xSpeed - this.accel * dt / 4) : (this.xSpeed + this.accel * dt / 4);\n\n        if( Math.abs(this.xSpeed) > this.maxMoveSpeed) {\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        }        \n\n        this.node.x += this.xSpeed * dt;\n    },\n});\n"]}